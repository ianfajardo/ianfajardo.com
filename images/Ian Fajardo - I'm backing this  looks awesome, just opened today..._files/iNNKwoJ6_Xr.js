/*!CK:653541181!*//*1405432823,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["hwqQt"]); }

__d("AllActivityContentLoader",["ActivityLogScrubberConfig","Arbiter","CSS","DOM","DOMScroll","OnVisible","Parent","ScrollingPager","TimelineConstants","TimelineController","TimelineLegacySections","TimelineSmartInsert","UIPagelet","Vector","$","clickRefAction","copyProperties","csx","userAction"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y){var z=false,aa=0,ba=null,ca={},da=[],ea={},fa=[],ga=null,ha=null;function ia(ma,na,oa,pa,qa){this.node=ma;this.canScrollLoad=true;this.scrubberKey=na;this._pageletLoadData=oa;this.loaded=pa;this.sortKey=qa;this.contentNode=j.scry(ma,"div._z6j")[0];}function ja(){if(z)return;p.register(p.CONTENT,la);ga=y('allactivity').uai('init','scrubber',false);v('scrubber').set_namespace('allactivity');z=true;}function ka(ma){var na=q.get(ma);na&&na.canScrollLoad&&na.load();}w(ia.prototype,{load:function(){if(this.loaded)return;this.loaded=true;this.contentNode&&i.hide(this.contentNode);i.show(m.byClass(this.node,'fbTimelineSection'));var ma=g.gkResults?'TimelineEntStoryActivityLogPagelet':'TimelineProfileAllActivityPagelet',na=this.node;function oa(qa){r.run(na,qa);}var pa=j.find(this.node,'div.fbTimelineLogStream');fa.push(s.loadFromEndpoint(ma,pa.id,this._pageletLoadData,{usePipe:true,jsNonblock:true,constHeight:true,displayCallback:oa,append:true}));},contentAdded:function(ma){if(!this.hasContent){i.removeClass(m.byClass(this.node,'stat_elem'),'async_saving');if(this.contentNode){ma&&j.prependContent(this.contentNode,ma);i.show(this.contentNode);}this.hasContent=true;}},fullyLoaded:function(){if(!this.hasContent){i.removeClass(m.byClass(this.node,'stat_elem'),'async_saving');i.show(j.find(this.node,"div._40pu"));this.contentNode&&i.hide(this.contentNode);}},activateScrollLoad:function(){this.canScrollLoad=true;ea[this.scrubberKey]&&ea[this.scrubberKey].reset();},deactivateScrollLoad:function(){if(!this.loaded){this.canScrollLoad=false;}else{var ma=j.scry(this.node,'div.all_activity_pager')[0];if(ma){var na=n.getInstance(ma.id);if(na){na.removeOnVisible();i.removeClass(j.scry(ma,'div.uiMorePager')[0],'async_saving');}}}ea[this.scrubberKey]&&ea[this.scrubberKey].remove();},getParent:function(){if(this.parentKey)return q.get(this.parentKey);return null;}});var la={SCROLL_TO_OFFSET:115,HEADER_SCROLL_CUTOFF:30,CURRENT_SECTION_OFFSET:150,registerTimePeriod:function(ma,na,oa,pa,qa,ra){ja();var sa=new ia(ma,na,oa,pa,ra);if(!qa){da.push(na);ca[na]=true;}else{sa.parentKey=qa;q.get(qa).subSections=q.get(qa).subSections||[];q.get(qa).subSections.push(sa);q.get(qa).subSections.sort(function(ta,ua){return ua.sortKey-ta.sortKey;});}q.set(na,sa);la.checkCurrentSectionChange();h.inform(o.SECTION_REGISTERED,{scrubberKey:na},h.BEHAVIOR_PERSISTENT);},reset:function(){la.stopLoadingContent();z=false;q.removeAll();aa=0;ba=null;ca={};da=[];ea={};fa=[];ga=null;ha=null;},stopLoadingContent:function(){for(var ma in ea)ea[ma]&&ea[ma].remove();for(var na=0;na<fa.length;na++)fa[na].cancel();},setContentHeader:function(ma){ha=ma;},checkCurrentSectionChange:function(){var ma=la.getCurrentSection(),na=ba&&ba.scrubberKey;if(ma&&ma.scrubberKey!==na){ba=ma;var oa=ma.scrubberKey,pa=ma.parentKey;if(!pa){pa=oa;oa=null;}p.sectionHasChanged(pa,oa);}},getCurrentSection:function(){var ma={},na=q.getAll();for(var oa in na){var pa=na[oa];if(!pa.loaded)continue;var qa=t.getElementPosition(pa.node,'viewport').y;if(qa<la.CURRENT_SECTION_OFFSET)ma[qa]=pa;}var ra=Math.max.apply(this,Object.keys(ma)),sa=ra==-Infinity;if(!sa){return ma[ra];}else return null;},enableScrollLoad:function(ma,na,oa){ma=u(ma);var pa=la.getNextSectionKey(na);if(pa)ea[pa]=new l(ma,ka.bind(null,pa),false,oa||1000);},getNextSectionKey:function(ma){var na=q.get(ma),oa=na.getParent(),pa=null,qa=null;if(oa)for(var ra=0;ra<oa.subSections.length-1;ra++)if(oa.subSections[ra].scrubberKey==ma)pa=oa.subSections[ra+1].scrubberKey;if(!pa)for(var sa=0;sa<da.length-sa;sa++)if(da[sa]==oa.scrubberKey){qa=q.get(da[sa+1]).subSections[0];if(qa)pa=qa.scrubberKey;}return pa;},navigateToSection:function(ma,na,oa){ga.add_event("nav_"+ma);na=!!na;var pa=q.get(ma);if(!pa)return;if(!pa.getParent()){ma=pa.subSections[0].scrubberKey;pa=q.get(ma);}for(var qa=0;qa<da.length;qa++){var ra=q.get(da[qa]);for(var sa=0;sa<ra.subSections.length;sa++){if(ra.subSections[sa].scrubberKey==ma)break;ra.subSections[sa].deactivateScrollLoad();}if(ra.scrubberKey==pa.getParent().scrubberKey)break;}pa.activateScrollLoad();pa.load();la.adjustContentPadding();var ta=t.getScrollPosition().x,ua=t.getElementPosition(pa.node).y;if(!na){var va=la.SCROLL_TO_OFFSET;k.scrollTo(new t(ta,ua-va,'document'));}},adjustContentPadding:function(){u('fbTimelineLogBody').style.paddingBottom=t.getViewportDimensions().y-la.CURRENT_SECTION_OFFSET-la.HEADER_SCROLL_CUTOFF+'px';},sectionHasContent:function(ma){var na=q.get(ma);na&&na.contentAdded(ha);ha=null;},sectionFullyLoaded:function(ma){var na=q.get(ma);na&&na.fullyLoaded();}};e.exports=la;},null);
__d("PopoverMenuDynamicTooltip",["DOMQuery","Tooltip","csx"],function(a,b,c,d,e,f,g,h,i){function j(k){"use strict";this._popoverMenu=k;this._setMenuSubscription=null;this._changeSubscription=null;}j.prototype.enable=function(){"use strict";this._setMenuSubscription=this._popoverMenu.subscribe('setMenu',this._onSetMenu.bind(this));};j.prototype.disable=function(){"use strict";this._popoverMenu.unsubscribe(this._setMenuSubscription);this._setMenuSubscription=null;this._removeChangeSubscription();};j.prototype._onSetMenu=function(){"use strict";this._removeChangeSubscription();this._menu=this._popoverMenu.getMenu();this._changeSubscription=this._menu.subscribe('change',function(k,l){var m=l.item;if(l[0])m=l[0].item;if(!m)return;var n=m.getLabel();n=n?n.toString():null;if(!n)return;var o=this._popoverMenu.getTriggerElem(),p=g.scry(o,"span._55pe")[0];if(p&&p.nodeName){var q=p.parentNode;if(q)h.set(q,n);}}.bind(this));};j.prototype._removeChangeSubscription=function(){"use strict";if(this._changeSubscription){this._menu.unsubscribe(this._changeSubscription);this._changeSubscription=null;}};e.exports=j;},null);
__d("ScrollHighlight",["DOMScroll","highlight"],function(a,b,c,d,e,f,g,h){var i={actOn:function(j,k,l){g.scrollTo(j,true,false,false,l);h(j,null,k);}};e.exports=i;},null);
__d("ProfileApprovalController",["AsyncRequest","DOM","Event","HTML","$","copyProperties","ge"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(o){"use strict";this.queueType=o;var p=m('profileApprovalSeeMoreLink');if(p)i.listen(p,'click',this.clickedSeeMore.bind(this));}n.prototype.getNewStories=function(){"use strict";var o=this.getStoryData(),p={filter:this.FILTER_NEWER,filter_timestamp:o.newest_time,filter_fbid:o.newest_fbid};new g().setURI('/ajax/profile/approval/get_more.php').setData(p).setHandler(this.handleContent).send();};n.prototype.clickedSeeMore=function(){"use strict";var o=this.getStoryData(),p={queue_type:this.queueType,filter:this.FILTER_OLDER,filter_timestamp:o.oldest_time,filter_fbid:o.oldest_fbid};new g().setURI('/ajax/profile/approval/get_more.php').setData(p).setHandler(this.handleContent).send();};n.prototype.handleContent=function(o){"use strict";var p=o.payload;if(p.pager_error){h.replace(k('profileApprovalSeeMoreContainer'),j(p.pager_markup));return;}if(p.hide_more_pager)h.remove(k('profileApprovalSeeMoreContainer'));if(!p.items_markup)return;if(p.insert_before)h.prependContent(h.find(k('profileApprovalContentContainer'),'.profileApprovalList'),j(p.items_markup));if(p.insert_after)h.appendContent(h.find(k('profileApprovalContentContainer'),'.profileApprovalList'),j(p.items_markup));};n.prototype.getStoryData=function(){"use strict";var o=h.scry(k('profileApprovalContentContainer'),'.profileApprovalStoryContainer');if(!o)return;var p=o[0],q=o[o.length-1];return {newest_time:p.getAttribute('data-timestamp'),newest_fbid:p.getAttribute('data-fbid'),oldest_time:q.getAttribute('data-timestamp'),oldest_fbid:q.getAttribute('data-fbid')};};n.NO_MORE_CONTENT='no_more_content';l(n.prototype,{FILTER_NONE:0,FILTER_OLDER:1,FILTER_NEWER:2});e.exports=n;},null);
__d("legacy:profile-approval-controller",["ProfileApprovalController"],function(a,b,c,d){a.ProfileApprovalController=b('ProfileApprovalController');},3);
__d("TimelineAllActivitySideNav",["CSS","DOM","DOMDimensions","FutureSideNav","PageTransitions","Style","UIPagelet","$","copyProperties","csx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var q={init:function(r,s,t,u){var v=h.find(n('contentArea'),"._6-0"),w=h.getID(v);l.set(v,'minHeight',i.getViewportDimensions().height+'px');g.addClass(r,'fixed_elem');k.registerHandler(function(x){if(s===x.getPath()&&x.getQueryData().sk==t){var y=o({profile_id:u,renderContentsOnly:1,uripath:x.toString()},x.getQueryData()),z=j.getInstance(),aa=z&&z._getItemForKey(y.log_filter||'all');aa&&z.setLoading(aa);m.loadFromEndpoint('TimelineAllActivityColumn',w,y,{jsNonblock:true,constHeight:true,displayCallback:function(ba){ba();aa&&z.setSelected(aa);document.body.scrollTop=0;k.transitionComplete(true);}});return true;}return false;});}};e.exports=q;},null);
__d("ApprovalQueueCountUpdater",["ge","Arbiter","DOM"],function(a,b,c,d,e,f,g,h,i){var j={updateCounts:function(k,l){var m=k.friends+k.others,n=g('tag_count_friends'),o=g('tag_count_other');h.inform('NavigationMessage/navigationCount',{key:'review',count:m,hide:true});i.setContent(n,k.friends<=l?k.friends:l+"+");i.setContent(o,k.others<=l?k.others:l+"+");}};e.exports=j;},null);